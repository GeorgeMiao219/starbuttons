(function(t){function e(e){for(var a,o,s=e[0],c=e[1],l=e[2],d=0,f=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&f.push(n[o][0]),n[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(e);while(f.length)f.shift()();return i.push.apply(i,l||[]),r()}function r(){for(var t,e=0;e<i.length;e++){for(var r=i[e],a=!0,s=1;s<r.length;s++){var c=r[s];0!==n[c]&&(a=!1)}a&&(i.splice(e--,1),t=o(o.s=r[0]))}return t}var a={},n={app:0},i=[];function o(e){if(a[e])return a[e].exports;var r=a[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=t,o.c=a,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(r,a,function(e){return t[e]}.bind(null,a));return r},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=c;i.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("cd49")},"0340":function(t,e,r){"use strict";var a=r("4124"),n=r.n(a);n.a},4124:function(t,e,r){},"485b":function(t,e,r){"use strict";var a=r("60c3"),n=r.n(a);n.a},"60c3":function(t,e,r){},7999:function(t,e,r){"use strict";var a=r("d935"),n=r.n(a);n.a},b32a:function(t,e,r){"use strict";var a=r("c6b8"),n=r.n(a);n.a},c6b8:function(t,e,r){},cd49:function(t,e,r){"use strict";r.r(e);r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("2b0e"),n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"app"}},[r("router-view")],1)},i=[],o=r("2877"),s={},c=Object(o["a"])(s,n,i,!1,null,null,null),l=c.exports,u=r("8c4f"),d=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"app"}},[r("div",{staticClass:"settingsBtn",attrs:{title:t.$t("Toggle chorus mode")}},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.multiPlay,expression:"multiPlay"}],attrs:{type:"checkbox",id:"isMutliplay"},domProps:{checked:Array.isArray(t.multiPlay)?t._i(t.multiPlay,null)>-1:t.multiPlay},on:{change:function(e){var r=t.multiPlay,a=e.target,n=!!a.checked;if(Array.isArray(r)){var i=null,o=t._i(r,i);a.checked?o<0&&(t.multiPlay=r.concat([i])):o>-1&&(t.multiPlay=r.slice(0,o).concat(r.slice(o+1)))}else t.multiPlay=n}}}),r("label",{attrs:{for:"isMutliplay"}},[t._v(t._s(t.$t("Do Not Click Me")))])]),r("div",{attrs:{id:"mainWrapper"}},[r("div",{class:{musicBoard:t.displayMusicBoard,musicButton:!t.displayMusicBoard,btn:!t.displayMusicBoard,animateBtn:!t.displayMusicBoard},attrs:{id:"board"},on:{click:t.playEhhh}},[r("div",{attrs:{id:"boardWrapper"}},[t._l(t.sounds,(function(e,a){return[t.displayMusicBoard?r("BaseButton",{key:a,staticClass:"normalBtn",attrs:{item:e}}):t._e()]}))],2),r("span",{attrs:{id:"bigButtonText"}},[t._v(" "+t._s(t.ehhhLocalizedName)+" ")])])]),r("BaseButton",{ref:"centralButton",attrs:{id:"virtualCentralButton",item:t.sounds[0]}}),r("div",{staticClass:"btn animateBtn",attrs:{id:"switchBtn"},on:{click:function(e){t.displayMusicBoard=!t.displayMusicBoard}}},[t._v(" "+t._s(t.displayMusicBoard?t.$t("Back"):t.$t("Music board"))+" ")]),r("div",{attrs:{id:"bottom"}},[r("a",{staticClass:"bottonBtnLink",attrs:{href:"https://github.com/suisei-cn/starbuttons",target:"_blank"}},[t._v(" "+t._s(t.$t("GitHub")))]),t._v("/ "),r("a",{staticClass:"bottonBtnLink",attrs:{href:"https://t.me/Hoshimati_Suisei",target:"_blank"}},[t._v(" "+t._s(t.$t("Telegram"))+" ")])])],1)},f=[],h=(r("b0c0"),r("d3b7"),r("ac1f"),r("466d"),r("841c"),r("1276"),r("96cf"),r("1da1")),p=r("d4ec"),m=r("bee2"),v=r("262e"),y=r("2caf"),b=r("9ab4"),g=r("60a3"),k=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"btn animateBtn",class:{playingBtn:t.playLayer>0},on:{click:t.play}},[t._v(" "+t._s(t.localizedName)+" ")])},x=[],w=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{ref:"self",class:{playingBtn:t.playLayer>0,testHoverWidth:t.testHoverWidth},style:{minWidth:t.minWidth},on:{click:t.play}},[t._v(" "+t._s(t.localizedName)+" ")])},O=[],j=function(t){Object(v["a"])(r,t);var e=Object(y["a"])(r);function r(){var t;return Object(p["a"])(this,r),t=e.apply(this,arguments),t.playLayer=0,t.testHoverWidth=!1,t.minWidth="0px",t.lang="zh",t}return Object(m["a"])(r,[{key:"mounted",value:function(){var t=this;this.lang=this.$i18n.locale,this.testHoverWidth=!0,this.$nextTick((function(){var e=t.$refs.self.offsetWidth;t.minWidth=String(e-16+"px"),t.testHoverWidth=!1}))}},{key:"play",value:function(){if(!this.noclickplay&&this.item&&(!(this.$store.getters.playing>0)||this.$store.state.multiPlay)){var t;t="string"===typeof this.item.file?this.item.file:this.item.file[Math.floor(Math.random()*this.item.file.length)];var e=new Audio("assets/".concat(t)),r=this;e.addEventListener("play",(function(){r.playLayer+=1,r.$store.commit("playOne")})),e.addEventListener("ended",(function(){r.playLayer-=1,r.$store.commit("stopOne")})),e.play()}}},{key:"localizedName",get:function(){return((null===this||void 0===this?void 0:this.item.name_l10n)||{})[this.lang]||(null===this||void 0===this?void 0:this.item.name)||""}}]),r}(g["c"]);Object(b["a"])([Object(g["b"])()],j.prototype,"item",void 0),Object(b["a"])([Object(g["b"])()],j.prototype,"noclickplay",void 0),j=Object(b["a"])([g["a"]],j);var _=j,B=_,S=Object(o["a"])(B,w,O,!1,null,null,null),$=S.exports,P=function(t){Object(v["a"])(r,t);var e=Object(y["a"])(r);function r(){return Object(p["a"])(this,r),e.apply(this,arguments)}return r}($);P=Object(b["a"])([g["a"]],P);var C=P,M=C,A=(r("7999"),Object(o["a"])(M,k,x,!1,null,"0f5b01ee",null)),E=A.exports,R=function(t){Object(v["a"])(r,t);var e=Object(y["a"])(r);function r(){var t;return Object(p["a"])(this,r),t=e.apply(this,arguments),t.sounds=[{}],t.displayMusicBoard=!1,t}return Object(m["a"])(r,[{key:"playEhhh",value:function(){this.displayMusicBoard||this.$refs.centralButton.play()}},{key:"mounted",value:function(){var t=Object(h["a"])(regeneratorRuntime.mark((function t(){var e,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/sounds.json").then((function(t){return t.json()})).catch((function(){console.error("Sound data fetch error. Exiting.")}));case 2:this.sounds=t.sent,r=((null===(e=window.location.search.match(/lang=([a-zA-Z-]+)/))||void 0===e?void 0:e[1])||navigator.language||navigator.userLanguage).split("-")[0]||"zh",this.$i18n.locale=r;case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"multiPlay",get:function(){return this.$store.state.multiPlay},set:function(t){this.$store.commit("setMultiPlay",t)}},{key:"ehhhLocalizedName",get:function(){return((null===this||void 0===this?void 0:this.sounds[0].name_l10n)||{})[this.$i18n.locale]||(null===this||void 0===this?void 0:this.sounds[0].name)||""}}]),r}(g["c"]);R=Object(b["a"])([Object(g["a"])({components:{CentralButton:E,BaseButton:$}})],R);var T=R,L=T,H=(r("b32a"),r("485b"),Object(o["a"])(L,d,f,!1,null,"1ed38f80",null)),N=H.exports,z=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"page"}},[r("div",{attrs:{id:"header"}},[r("h1",[t._v(" "+t._s(t.$t("Suisei Remix Editor"))+" "),r("sup",[t._v(t._s(t.$t("experimental")))])]),r("p",{domProps:{innerHTML:t._s(t.$t("long-editor-description"))}}),r("div",{style:{display:1===t.smallScreen?"none":"flex",opacity:2===t.smallScreen?0:1},attrs:{id:"operations"}},[r("div",{staticClass:"normalBtn",on:{click:t.playRemix}},[t._v(t._s(t.$t("Play")))]),r("div",{staticClass:"normalBtn",on:{click:t.exportRemix}},[t._v(t._s(t.$t("Export")))]),r("div",{staticClass:"normalBtn",on:{click:t.clearRemix}},[t._v(t._s(t.$t("Clear")))])])]),r("div",{style:{display:0===t.smallScreen?"none":"block"},attrs:{id:"smallScreen"}},[r("p",[t._v(" "+t._s(t.$t("Your device screen is too small to run this editor. Sorry~"))+" ")])]),r("div",{style:{display:1===t.smallScreen?"none":"block",opacity:2===t.smallScreen?0:1}},[r("div",{ref:"clips",attrs:{id:"buttons"}},[t._l(t.sounds,(function(t,e){return[r("BaseButton",{key:e,staticClass:"item normalBtn",attrs:{item:t,noclickplay:!0,"data-sound-id":e}})]}))],2),r("div",{ref:"editor",attrs:{id:"editor"}},[t._m(0)])])])},D=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"tracks"}},[r("div",{staticClass:"track",attrs:{"data-track-id":"1"}}),r("div",{staticClass:"track",attrs:{"data-track-id":"2"}}),r("div",{staticClass:"track",attrs:{"data-track-id":"3"}}),r("div",{staticClass:"track",attrs:{"data-track-id":"4"}})])}],W=(r("99af"),r("a9e3"),r("4fad"),r("07ac"),r("3835")),q=r("5530"),Y=r("b85c"),G=r("5014"),F=r.n(G),J=(r("3ca3"),r("ddb0"),r("2b3d"),r("574a"));function U(t){return V.apply(this,arguments)}function V(){return V=Object(h["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){J(e,128,null,(function(e){t(e)}))})));case 1:case"end":return t.stop()}}),t)}))),V.apply(this,arguments)}function Z(t){return I.apply(this,arguments)}function I(){return I=Object(h["a"])(regeneratorRuntime.mark((function t(e){var r,a,n,i,o,s,c,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=new OfflineAudioContext(2,220500,44100),a=Object(Y["a"])(e),t.prev=2,i=regeneratorRuntime.mark((function t(){var e,a,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=n.value,console.log("Fetching ".concat(e.musicurl)),t.next=4,fetch(e.musicurl).then((function(t){return t.blob()})).then((function(t){return t.arrayBuffer()}));case 4:return a=t.sent,i=r.createBufferSource(),t.next=8,r.decodeAudioData(a).catch((function(t){console.log("Error when decoding ".concat(e.musicurl,":"),t)}));case 8:if(o=t.sent,o){t.next=11;break}return t.abrupt("return","continue");case 11:console.log("Decoded ".concat(e.musicurl," delaying"),o,e.delay),i.buffer=o,i.connect(r.destination),i.start(e.delay);case 15:case"end":return t.stop()}}),t)})),a.s();case 5:if((n=a.n()).done){t.next=12;break}return t.delegateYield(i(),"t0",7);case 7:if(o=t.t0,"continue"!==o){t.next=10;break}return t.abrupt("continue",10);case 10:t.next=5;break;case 12:t.next=17;break;case 14:t.prev=14,t.t1=t["catch"](2),a.e(t.t1);case 17:return t.prev=17,a.f(),t.finish(17);case 20:return console.log("Rendering..."),t.next=23,r.startRendering();case 23:return s=t.sent,t.next=26,U(s);case 26:return c=t.sent,l=URL.createObjectURL(c),t.abrupt("return",l);case 29:case"end":return t.stop()}}),t,null,[[2,14,17,20]])}))),I.apply(this,arguments)}var K={};function Q(t){return t.offsetLeft+Number(t.getAttribute("data-x")||-1*t.offsetLeft)}function X(t,e,r){var a=(parseFloat(t.getAttribute("data-x")||"")||0)+e,n=(parseFloat(t.getAttribute("data-y")||"")||0)+r;t.style.webkitTransform=t.style.transform="translate("+a+"px, "+n+"px)",t.setAttribute("data-x",String(a)),t.setAttribute("data-y",String(n))}function tt(t){var e=t.target;X(e,t.dx,t.dy);var r=Number(e.getAttribute("data-seq-id"));if(K[r]){var a=Q(e);K[r].location=a}}window.editorElements=K;var et=function(t){Object(v["a"])(r,t);var e=Object(y["a"])(r);function r(){var t;return Object(p["a"])(this,r),t=e.apply(this,arguments),t.sounds=[],t.smallScreen=0,t.timelineLength=3,t}return Object(m["a"])(r,[{key:"loadVoice",value:function(){var t=Object(h["a"])(regeneratorRuntime.mark((function t(){var e,r,a,n,i,o,s,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/sounds.json").then((function(t){return t.json()})).catch((function(){console.error("Sound data fetch error. Exiting.")}));case 2:e=t.sent,r=Object(Y["a"])(e);try{for(r.s();!(a=r.n()).done;)if(n=a.value,"string"===typeof n.file)this.sounds.push(n);else for(i=0;i<n.file.length;i++){for(s in o=Object(q["a"])({},n.name_l10n),o)o[s]+=" (".concat(i+1,")");c=Object.assign({},n,{name:"".concat(n.name," (").concat(i+1,")"),name_l10n:o,file:n.file[i]}),this.sounds.push(c)}}catch(l){r.e(l)}finally{r.f()}console.log(this.sounds);case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"loadLang",value:function(){var t,e=((null===(t=window.location.search.match(/lang=([a-zA-Z-]+)/))||void 0===t?void 0:t[1])||navigator.language||navigator.userLanguage).split("-")[0]||"zh";this.$i18n.locale=e}},{key:"validateDisplay",value:function(){if(window.innerHeight>600)this.smallScreen=0;else{this.smallScreen=2;var t=this.$refs.editor.offsetHeight+this.$refs.editor.offsetTop;window.innerHeight<t?this.smallScreen=1:0!==t&&(this.smallScreen=0)}}},{key:"mounted",value:function(){var t=Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.loadVoice();case 2:this.loadLang(),this.validateDisplay(),window.addEventListener("resize",this.validateDisplay),this.initDrag();case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"initDrag",value:function(){var t=this.$refs.clips.offsetLeft,e=this.$refs.clips.offsetTop,r=this;F()(".item").draggable({inertia:!1,modifiers:[F.a.modifiers.restrictRect({restriction:document.getElementById("page"),endOnly:!0})],listeners:{move:function(t){tt(t)},end:function(a){tt(a);var n=a.target;if(n.getAttribute("data-seq-id")){if(!n.getAttribute("data-in-track")){var i=n.cloneNode(!0);i.style.webkitTransform=i.style.transform="",i.removeAttribute("data-x"),i.removeAttribute("data-y"),i.removeAttribute("data-seq-id"),i.removeAttribute("data-in-track"),r.$refs.clips.appendChild(i),n.setAttribute("data-in-track","1"),X(n,n.offsetLeft-t-12,n.offsetTop-e-12),n.style.position="absolute"}}else n.getAttribute("data-in-track")?r.$refs.clips.removeChild(n):(n.style.webkitTransform=n.style.transform="",n.removeAttribute("data-x"),n.removeAttribute("data-y"))}}}),F()(".track").dropzone({accept:".item",ondragenter:function(t){var e=t.relatedTarget,r=e.getAttribute("data-seq-id");r||(r=String(Math.random()),e.setAttribute("data-seq-id",r),K[r]={id:Number(e.getAttribute("data-sound-id")),location:-1})},ondragleave:function(t){var e=t.relatedTarget,r=e.getAttribute("data-seq-id");r&&(K[r]&&delete K[r],e.removeAttribute("data-seq-id"))}})}},{key:"playRemix",value:function(){var t=document.getElementsByClassName("track");if(t){for(var e=t[0],r=Number(e.offsetWidth)/this.timelineLength,a={},n=0,i=Object.entries(K);n<i.length;n++){var o=Object(W["a"])(i[n],2),s=o[0],c=o[1];if(!(c.id<0)){var l=c.id,u=a[s];if(!u){var d=this.sounds[l].file,f=new Audio("assets/".concat(d));f.preload="auto",a[s]=f}}}for(var h=function(){var t=Object(W["a"])(m[p],2),e=t[0],n=t[1];if(n.id<0||n.location<0)return"continue";setTimeout((function(){a[e].play()}),n.location/r*1e3)},p=0,m=Object.entries(K);p<m.length;p++)h()}}},{key:"clearRemix",value:function(){var t,e=Object(Y["a"])(document.querySelectorAll(".item[data-seq-id]"));try{for(e.s();!(t=e.n()).done;){var r=t.value;this.$refs.clips.removeChild(r)}}catch(a){e.e(a)}finally{e.f()}K={}}},{key:"exportRemix",value:function(){var t=Object(h["a"])(regeneratorRuntime.mark((function t(){var e,r,a,n,i,o,s,c,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=document.getElementsByClassName("track"),e){t.next=3;break}return t.abrupt("return");case 3:for(r=e[0],a=[],n=Number(r.offsetWidth)/this.timelineLength,i=0,o=Object.values(K);i<o.length;i++)s=o[i],a.push({musicurl:"assets/".concat(this.sounds[s.id].file),delay:s.location/n});return t.next=9,Z(a);case 9:c=t.sent,l=document.createElement("a"),l.href=c,l.download="output.mp3",l.click();case 14:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}]),r}(g["c"]);et=Object(b["a"])([Object(g["a"])({components:{BaseButton:$}})],et);var rt=et,at=rt,nt=(r("0340"),Object(o["a"])(at,z,D,!1,null,"d0624b52",null)),it=nt.exports;a["a"].use(u["a"]);var ot=[{path:"/",name:"Home",component:N},{path:"/editor",name:"Editor",component:it}],st=new u["a"]({routes:ot}),ct=st,lt=r("2f62");a["a"].use(lt["a"]);var ut=new lt["a"].Store({state:{concurPlay:0,multiPlay:!0},getters:{playing:function(t){return t.concurPlay>0}},mutations:{playOne:function(t){t.concurPlay+=1},stopOne:function(t){t.concurPlay>0&&(t.concurPlay-=1)},setMultiPlay:function(t,e){t.multiPlay=e}}}),dt=r("a925"),ft={"Do Not Click Me":"没事不要点",GitHub:"代码猫",Telegram:"观星台","Toggle chorus mode":"多重吟唱模式开关","Music board":"声音面板",Back:"返回","Suisei Remix Editor":"星音混响编辑器",experimental:"实验性",Play:"播放",Export:"导出",Clear:"清除","Your device screen is too small to run this editor. Sorry~":"你的屏幕尺寸过小，不适合运行此编辑器。抱歉～","long-editor-description":"你可以在此页对星音剪辑进行组合，并且导出你的作品。<br>轨道总长度为 5 秒。拖动声音剪辑按钮到轨道上以添加音频片段。<br>在创作衍生作品时，请遵守 <a href='https://hololive.tv/terms'>Hololive 二创条例</a>。<br>（这是一个实验性编辑器。在将来可能会有大量改变及功能添加。）"},ht={"Do Not Click Me":"Do Not Click Me",GitHub:"GitHub",Telegram:"Telegram","Toggle chorus mode":"Toggle chorus mode","Music board":"Music board",Back:"Back","Suisei Remix Editor":"Suisei Remix Editor",experimental:"experimental",Play:"Play",Export:"Export",Clear:"Clear","Your device screen is too small to run this editor. Sorry~":"Your device screen is too small to run this editor. Sorry~","long-editor-description":"Here you can remix with Suisei's voice clips and export your sparks.<br>The full track length is 5 seconds. Drag the voice clip button on wherever you want on the track.<br>Please comply to <a href='https://en.hololive.tv/terms'>Hololive's fan work guidelines</a> when creating derivative works.<br>(This editor is experimental and may change a lot and add many features in the future.)"},pt={"Do Not Click Me":"クリックしないでください",GitHub:"GitHub",Telegram:"Telegram","Toggle chorus mode":"Toggle chorus mode","Music board":"Music board",Back:"Back","Suisei Remix Editor":"Suisei Remix Editor",experimental:"experimental",Play:"Play",Export:"Export",Clear:"Clear","Your device screen is too small to run this editor. Sorry~":"Your device screen is too small to run this editor. Sorry~","long-editor-description":"Here you can remix with Suisei's voice clips and export your sparks.<br>The full track length is 5 seconds. Drag the voice clip button on wherever you want on the track.<br>Please comply to <a href='https://hololive.tv/terms'>Hololive's fan work guidelines</a> when creating derivative works.<br>(This editor is experimental and may change a lot and add many features in the future.)"};a["a"].use(dt["a"]);var mt=new dt["a"]({locale:"zh",fallbackLocale:"en",messages:{en:ht,ja:pt,zh:ft}});a["a"].config.productionTip=!1,new a["a"]({router:ct,store:ut,i18n:mt,render:function(t){return t(l)}}).$mount("#app")},d935:function(t,e,r){}});
//# sourceMappingURL=app.d38f0343.js.map